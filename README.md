# spreadsheet
Spreadsheet - это упрощенная версия электронной таблицы такой, как Microsoft Excel или Google Sheets. В ячейках таблицы могут быть текст или формулы. Формулы, как и в существующих решениях, могут содержать индексы ячеек.

**Подробное описание проекта:**
  **Типы ячеек:**
    Ячейки могут трактоваться как текстовые и формульные. 
    Ячейка формульная, если её текст начинается со знака "=". То, что следует после знака "=", называется выражением формулы.
    Все остальные ячейки трактуются как текстовые.

  **Обработка формул:**
      Правила, по которым определяется, в каком порядке выполнять операции, в соответствии с приоритетом операций. В данном проекте формулы       представляются именно в виде абстрактных синтаксических деревьев. Их корень задаёт всё дерево, потому что из корня можно обойти все узлы.      внутренние узлах находятся операции, а в листьях — операнды. 
      Чтобы работать с формулой нужно разбить строки на токены и составить дерева разбора. Для этого есть готовое решение — ANTLR                 (https://ru.wikipedia.org/wiki/ANTLR).

   **Ошибки, которые могут возникнуть при вычислении формул:**
      #ARITHM! - Ошибки вычисления: Например деление на 0.
      #VALUE! - Если ячейку, чей индекс входит в формулу, нельзя проинтерпретировать как число.
      #REF! - Формула может содержать ссылку на ячейку, которая выходит за границы возможного размера таблицы.
      Циклические зависимости - Программа выбрасывает исключение CircularDependencyException, а ячейка не меняется.

 ** Пример использования программы:**

void PrintSheet(const std::unique_ptr<SheetInterface>& sheet) {
    std::cout << sheet->GetPrintableSize() << std::endl; //вывод размера таблицы, например, (5, 4)
    sheet->PrintTexts(std::cout); //вывод таблицы в том виде, в котором ее записал пользователь
    std::cout << std::endl;
    sheet->PrintValues(std::cout); //вывод посчтитанной таблицы
    std::cout << std::endl;
}

int main() {

auto sheet = CreateSheet();//создаем пустую таблицу

//заполняем данными
sheet->SetCell("A1"_pos, "=1/0");
sheet->SetCell("B1"_pos, "=1+(2*3)");

sheet->SetCell("A2"_pos, "some");
sheet->SetCell("B2"_pos, "text");
sheet->SetCell("C2"_pos, "here");

sheet->SetCell("C3"_pos, "'and'");
sheet->SetCell("D3"_pos, "'here");

sheet->SetCell("B5"_pos, "=1/0");

PrintSheet(sheet);//вывод таблицы
    return 0;
}

**Пример вывода таблицы по данным выше:**

//(5, 4)
//=1/0    =1+2*3
//some    text    here
//                'and'   'here
//
//        =1/0

//#ARITHM!        7
//some    text    here
//                and'    here
//
//        #ARITHM!
